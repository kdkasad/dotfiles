#!/bin/sh

ss_select() {
	maim -su | tee $path | xclip -i -selection clipboard -t image/png
	notify-send -a 'screenshot utility' "screenshot taken" "saved to <pre>$(echo "$path" | sed "s|^$HOME|~|")</pre><br><br>and copied to clipboard"
	exit
}

ss_full() {
	maim -u | tee $path | xclip -i -selection clipboard -t image/png
	notify-send -a 'screenshot utility' "screenshot taken" "saved to <pre>$(echo "$path" | sed "s|^$HOME|~|")</pre><br><br>and copied to clipboard"
	exit
}

optstring="ps"

path="$HOME/pictures/screenshots/$(date +'%Y-%m-%d_%H:%M:%S').png"

while getopts "$optstring" option; do
	case "$option" in
		p) path="$(find ~ -not -path '*/.*' -type d 2>/dev/null | sed -e "s|$HOME|~|" -e "s|[^/]$|\0/|" | dmenu -l 20 -p "choose output path:" | sed "s|^~|$HOME|")" ;;
		s) ss_select ;;
	esac
done

ss_full
