# Basic Settings
set preview true
set previewer ~/.local/bin/scripts/lf-preview
set nohidden
set drawbox true
set icons true
set ignorecase true

# Custom Functions
cmd open ${{
  case "$f" in
    *.tar|*.tar.*|*.tgz|*.txz) $EDITOR "$f" ;;
    *)
      case $(file --mime-type "$f" -bL) in
        text/*|application/json) $EDITOR "$f";;
        *) setsid -f xdg-open "$f" >/dev/null 2>&1 ;;
      esac
    ;;
  esac
}}

cmd mkdir ${{
  printf "Directory Name: "
  read ans
  mkdir -vp $ans
}}

cmd mkfile ${{
  printf "File Name: "
  read ans
  $EDITOR $ans
}}

cmd chmod ${{
  printf "Mode Bits: "
  read ans

  for file in "$fx"
  do
    chmod $ans $file
  done
}}

cmd setwallpaper %bgs -z "$f"

cmd fzf_jump ${{
  res="$(find . -maxdepth 3 | fzf --reverse --header='Jump to location')"
  if [ -f "$res" ]; then
    cmd="select"
  elif [ -d "$res" ]; then
    cmd="cd"
  fi
  lf -remote "send $id $cmd \"$res\""
}}

cmd broot_jump ${{
  f=$(mktemp)
  res="$(broot --outcmd $f && cat $f | sed 's/cd //')"
  rm -f "$f"
  if [ -f "$res" ]; then
    cmd="select"
  elif [ -d "$res" ]; then
    cmd="cd"
  fi
  lf -remote "send $id $cmd \"$res\""
}}

cmd dragon &dragon-drag-and-drop -a -x $fx

cmd pdf ${{
  echo -n "Output PDF name: "
  read ans
  convert -auto-orient $fx "$ans"
}}

cmd pdfmerge ${{
  echo -n "Output PDF name: "
  read ans
  pdfunite $fx "$ans"
}}

cmd cloc %find $fx -type f | xargs -r cat | wc -l

# Archive bindings
cmd unarchive %bsdtar -xvf "$f"

cmd zip %bsdtar -acvf "$f.zip" "$f"
cmd tar %tar -cvf "$f.tar" "$f"
cmd targz %tar -cvzf "$f.tar.gz" "$f"
cmd tarxz %tar -cvJf "$f.tar.xz" "$f"
cmd tarbz2 %tar -cjvf "$f.tar.bz2" "$f"

cmd simplename %simplename "$f"

# Bindings
# Remove some defaults
map d
map c
map f

# File Openers
map e $$EDITOR "$f"
map u $view "$f"

# Archive Mappings
map az zip
map at tar
map ag targz
map ax tarxz
map au unarchive

# drag-and-drop
map dr dragon

map sn simplename

# Basic Functions
map . set hidden!
map dd delete
map p paste
map x cut
map y copy
map <enter> open
map o open
map Mf mkfile
map Md mkdir
map ch chmod
map bg setwallpaper
map r rename
map gg top
map G bottom
map R reload
map C clear
map u unselect

# Movement
map gd cd ~/downloads
map gv cd ~/videos
map gp cd ~/pictures
map gw cd ~/pictures/wallpapers
map gd cd ~/documents
map gc cd ~/.config
map gls cd ~/.local/share
map gs cd ~/.local/bin/scripts
